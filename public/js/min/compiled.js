!function e(t,n,r){function a(o,u){if(!n[o]){if(!t[o]){var s="function"==typeof require&&require;if(!u&&s)return s(o,!0);if(i)return i(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return a(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)a(r[o]);return a}({1:[function(e,t,n){var r="map-canvas",a=e("./lib/geo_lit"),i=e("../config");a.init(r,function(e){console.log(e?e:"map initialzed")});var o=e("./components/addPlaceForm.jsx"),u=e("./components/comments.jsx"),s=e("./lib/user/index.jsx"),c=React.createClass({displayName:"Main",componentDidMount:function(){var e=this;$(document).on("geo-lit-place-click",function(t,n){e.setState({activeComponent:"comments",placeId:n._id,placeTitle:n.title})})},getInitialState:function(){return{activeComponent:"addPlaceForm",placeId:null,userId:1,user:null,isLoggedIn:!1}},loginCallback:function(e){console.log(e),this.setState({user:e,isLoggedIn:!0})},logoutCallback:function(){this.setState({user:null,isLoggedIn:!1})},render:function(){return React.createElement("div",null,React.createElement(s,{endpoint:i.userEndpoint,loginCallback:this.loginCallback,logoutCallback:this.logoutCallback}),React.createElement(o,{activeComponent:this.state.activeComponent}),React.createElement(u,{activeComponent:this.state.activeComponent,endpoint:i.commentEndpoint,placeId:this.state.placeId,placeTitle:this.state.placeTitle,userId:this.state.userId}))}});React.render(React.createElement(c,null),document.getElementById("content"))},{"../config":12,"./components/addPlaceForm.jsx":2,"./components/comments.jsx":3,"./lib/geo_lit":4,"./lib/user/index.jsx":7}],2:[function(e,t,n){var r=(e("../lib/services.js"),e("../lib/geo_lit.js"));t.exports=React.createClass({displayName:"exports",addPlace:function(e){var t=this;e.preventDefault(),r.addPlace(this.state.placeValue,function(e){e?t.setState({errorMessage:e}):console.log(t.state.placeValue+" added.")})},getInitialState:function(){return{placeValue:"",errorMessage:""}},render:function(){var e="js-add-place button expand";return React.createElement("div",null,React.createElement("div",null,this.state.errorMessage),React.createElement("form",null,React.createElement("div",{className:"row"},React.createElement("div",{className:"small-12 columns"},React.createElement("input",{type:"text",name:"title",placeholder:"Title",value:this.state.placeValue,onChange:this.updatePlaceValue}),React.createElement("a",{href:"javascript:void(0)",onClick:this.addPlace,className:e},"Add Place")))))},updatePlaceValue:function(e){this.setState({placeValue:e.target.value})}})},{"../lib/geo_lit.js":4,"../lib/services.js":5}],3:[function(e,t,n){{var r=e("underscore");e("../lib/services.js"),e("../lib/geo_lit.js")}t.exports=React.createClass({displayName:"exports",addComment:function(e,t){var n=this,r=n.props.endpoint+"/comment/"+n.props.placeId+"/"+e;$.ajax({type:"POST",url:r,data:{comment:t,userId:this.props.userId},success:function(e){"success"!==e.status?console.log(e):(n.setState({hasLoaded:!1}),n.loadComments(n.props.placeId))},error:function(e){console.log(e)},dataType:"JSON"})},cleanComments:function(e){var t=this;r.each(e,function(e){e.addComment=t.addComment,0!==e.children.length&&t.cleanComments(e.children)})},componentWillReceiveProps:function(e){e.placeId!==this.props.placeId&&(this.loadComments(e.placeId),this.setState({hasLoaded:!1}))},getInitialState:function(){return{hasLoaded:!1,comments:[]}},loadComments:function(e){var t=this;$.ajax({type:"GET",url:t.props.endpoint+"/comments-formatted/"+e,success:function(e){"success"!==e.status?console.log(e):(t.cleanComments(e.data),t.setState({comments:e.data,hasLoaded:!0}))},error:function(e){console.log(e)},dataType:"JSON"})},render:function(){return"comments"===this.props.activeComponent&&this.state.hasLoaded?React.createElement("div",null,React.createElement(a,{comments:[{parent:0,children:[],comment:"",addComment:this.addComment}]}),React.createElement("h2",null," "),React.createElement(a,{comments:this.state.comments})):React.createElement("div",null," ")},updatePlaceValue:function(e){this.setState({placeValue:e.target.value})}});var a=React.createClass({displayName:"Comments",render:function(){var e=this.props.comments.map(function(e,t){var n=!1;null===e.comment&&(n=!0);var r="";return 0!==e.children.length&&(r=React.createElement(a,{comments:e.children})),React.createElement(i,{parent:e.id,childrenElement:r,children:e.children,comment:e.comment,addComment:e.addComment,key:t})});return React.createElement("div",null,e)},updateComment:function(e){this.setState({comment:e.target.value})}}),i=React.createClass({displayName:"Comment",getInitialState:function(){return{comment:""}},handleSubmit:function(){event.preventDefault(),this.props.addComment(this.props.parent,this.state.comment),console.log(this.state.comment)},render:function(){var e=this;return React.createElement("div",{className:"sql-comment-container"},React.createElement("div",null,this.props.comment),React.createElement("textarea",{placeholder:"Add Comment",onChange:e.updateComment,value:e.state.comment}),React.createElement("button",{href:"javascript:null;",className:"button small",onClick:e.handleSubmit}," Submit"),React.createElement("div",null,this.props.childrenElement))},updateComment:function(e){this.setState({comment:e.target.value})}})},{"../lib/geo_lit.js":4,"../lib/services.js":5,underscore:13}],4:[function(e,t,n){var r={},a=e("underscore"),i=e("./user"),o=e("./services"),u=5,s=!1,c=.1,l="You must be logged in.";r.map=null,r.currentLatitude=null,r.currentLongitude=null,r.mapFollow=!0,r.intervalId=null,r.intervalTime=5e3,r.mapId=null,r.placeMarkers={},r.userMarker=null,r.zoomLevel=12,r.createMap=function(){var e={zoom:r.zoomLevel,center:new google.maps.LatLng(r.currentLatitude,r.currentLongitude)};r.map=new google.maps.Map(document.getElementById(r.mapId),e)},r.getPosition=function(e){navigator.geolocation.getCurrentPosition(function(t){e(null,{latitude:t.coords.latitude,longitude:t.coords.longitude})},e)},r.init=function(e,t){r.mapId=e,google.maps.event.addDomListener(window,"load",function(){r.updatePosition(function(e){e?t(e):(r.createMap(),r.updateUserMarker(),r.intervalId=window.setInterval(r.intervalCallback,r.intervalTime),t())})})},r.updatePosition=function(e){navigator.geolocation.getCurrentPosition(function(t){r.currentLatitude=t.coords.latitude,r.currentLongitude=t.coords.longitude,e()},e)},r.addPlacesToMap=function(e){a.each(e,function(e){var t=new google.maps.LatLng(e.location[1],e.location[0]);r.placeMarkers[e._id]=new google.maps.Marker({position:t,map:r.map,title:"TEST TITLE",geoLit:{_id:e._id,title:"TEST TITLE"}}),google.maps.event.addListener(r.placeMarkers[e._id],"click",function(){$(document).trigger("geo-lit-place-click",[this.geoLit])})})},r.updatePlaces=function(e){o.findNear({latitude:r.currentLatitude,longitude:r.currentLongitude,range:u},function(e,t){var n=a.filter(t,function(e){return"undefined"==typeof r.placeMarkers[e._id]});r.addPlacesToMap(n)})},r.updateUserMarker=function(){null!==r.userMarker&&r.userMarker.setMap(null);var e=new google.maps.LatLng(r.currentLatitude+.002,r.currentLongitude+.002);r.userMarker=new google.maps.Marker({position:e,map:r.map,title:"Current Position"}),r.mapFollow&&r.recenterMap()},r.recenterMap=function(){var e=new google.maps.LatLng(r.currentLatitude,r.currentLongitude);r.map.panTo(e)},r.intervalCallback=function(){var e=!0;r.updatePosition(function(t){return s&&(r.currentLatitude+=Math.random()*c,r.currentLongitude+=Math.random()*c),t?void console.log(t):(r.updateUserMarker(),void(e&&r.updatePlaces(function(e){e&&console.log(e)})))})},r.addPlace=function(e,t){return i.isLoggedIn?void r.getPosition(function(n,r){if(n)return void t("Unable to find location.");var a={};a.location=[r.longitude,r.latitude],a.title=e,a.user=i.id,o.add(a,function(e,n){e?t(e):t()})}):void t(l)},t.exports=r},{"./services":5,"./user":6,underscore:13}],5:[function(e,t,n){var r={},a=e("../../config.js"),i="A server error occurred.";r.add=function(e,t){$.ajax({type:"POST",url:a.geoLitEndpoint+"/position",data:e,success:function(e){"success"===e.status?t():t(e.errorMessage)},error:function(e){console.log(e),t(i)},dataType:"JSON"})},r.findNear=function(e,t){$.ajax({type:"GET",url:a.geoLitEndpoint+"/positions-near",data:e,success:function(e){"success"!==e.status?t(e.errorMessage):t(null,e.data)},error:function(e){console.log(e),t(i)},dataType:"JSON"})},t.exports=r},{"../../config.js":12}],6:[function(e,t,n){var r={};r.data={},r.isLoggedIn=!0,r.id=777,t.exports=r},{}],7:[function(e,t,n){var r=(e("./lib/input.jsx"),e("./lib/login_form.jsx")),a=e("./lib/register_form.jsx");t.exports=React.createClass({displayName:"exports",getInitialState:function(){return{activeForm:"register",isLoggedIn:!1,user:null}},handleMenuClickLogin:function(e){this.setState({activeForm:"login"})},handleMenuClickRegister:function(e){this.setState({activeForm:"register"})},loginCallback:function(e){this.setState({isLoggedIn:!0,user:e}),this.props.loginCallback&&this.props.loginCallback(e)},render:function(){var e=this,t={},n=["login","register"];return n.forEach(function(n){t[n]=n===e.state.activeForm}),React.createElement("div",{className:"sql-login-wrap"},React.createElement("div",{className:"sql-login-menu"},React.createElement("div",{className:"sql-login-menu-login",onClick:this.handleMenuClickLogin},"Login"),React.createElement("div",{className:"sql-login-menu-register",onClick:this.handleMenuClickRegister},"Register")),React.createElement("div",{style:t.login?{display:"inherit"}:{display:"none"}},React.createElement(r,{endpoint:this.props.endpoint,loginCallback:this.loginCallback})),React.createElement("div",{style:t.register?{display:"inherit"}:{display:"none"}},React.createElement(a,{endpoint:this.props.endpoint,loginCallback:this.loginCallback})))}})},{"./lib/input.jsx":8,"./lib/login_form.jsx":9,"./lib/register_form.jsx":10}],8:[function(e,t,n){t.exports=React.createClass({displayName:"exports",getInitialState:function(){return{value:""}},getInputValue:function(){return this.state.value},handleChange:function(e){this.setState({value:e.target.value})},render:function(){return React.createElement("div",null,React.createElement("label",null,this.props.label),React.createElement("input",{type:this.props.type,name:this.props.name,ref:this.props.ref,value:this.state.value,onChange:this.handleChange}))}})},{}],9:[function(e,t,n){var r=e("./input.jsx"),a=e("./services_handler.js");t.exports=React.createClass({displayName:"exports",getInitialState:function(){return{errorMessage:""}},handleSubmit:function(e){e.preventDefault();var t=this,n=this.refs.email.getInputValue(),r=this.refs.password.getInputValue();a.login(this.props.endpoint,n,r,function(e,n){return e?void t.setState({errorMessage:e}):(t.setState({errorMessage:""}),void(t.props.loginCallback&&t.props.loginCallback(n)))})},render:function(){return React.createElement("div",{className:"sql-login-login"},React.createElement("div",{className:"sql-login-error-message"},this.state.errorMessage),React.createElement("form",{method:"POST",onSubmit:this.handleSubmit},React.createElement(r,{name:"email",type:"text",label:"Email",ref:"email"}),React.createElement(r,{name:"password",type:"password",label:"Password",ref:"password"}),React.createElement("input",{type:"submit",value:"submit"})))}})},{"./input.jsx":8,"./services_handler.js":11}],10:[function(e,t,n){function r(e){var t=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return t.test(e)}var a=e("./input.jsx"),i=e("./services_handler.js");t.exports=React.createClass({displayName:"exports",passwordMinLength:8,errorEmail:"Email address is not valid.",errorPasswordsDontMatch:"The passwords do not match.",errorPasswordLength:"The password must be at least "+this.passwordMinLength+" characters.",getInitialState:function(){return{errorMessage:""}},handleSubmit:function(e){e.preventDefault();var t=this,n=this.refs.email.getInputValue(),r=this.refs.password.getInputValue(),a=this.refs.confirmPassword.getInputValue(),o=this.validate(n,r,a);return o!==!0?void this.setState({errorMessage:o}):void i.register(this.props.endpoint,n,r,function(e,n){return e?void t.setState({errorMessage:e}):(t.setState({errorMessage:""}),void(t.props.loginCallback&&t.props.loginCallback()))})},render:function(){return React.createElement("div",{className:"sql-login-register"},React.createElement("div",{className:"sql-login-error-message"},this.state.errorMessage),React.createElement("form",{method:"POST",onSubmit:this.handleSubmit},React.createElement(a,{name:"email",type:"text",label:"Email",ref:"email"}),React.createElement(a,{name:"password",type:"password",label:"Password",ref:"password"}),React.createElement(a,{name:"confirmPassword",type:"password",label:"ConfirmPassword",ref:"confirmPassword"}),React.createElement("input",{type:"submit",value:"Submit"})))},validate:function(e,t,n){return r(e)?t!==n?this.errorPasswordsDontMatch:t.length<this.passwordMinLength?this.errorPasswordLength:!0:this.errorEmail}})},{"./input.jsx":8,"./services_handler.js":11}],11:[function(e,t,n){var r="success",a="failure",i="error";t.exports={register:function(e,t,n,r){o({method:"POST",url:e+"/register",data:{email:t,password:n}},r)},login:function(e,t,n,r){o({method:"POST",url:e+"/login",data:{email:t,password:n}},r)}};var o=function(e,t){e.success=function(e){e.status===r?t(null,e.data):t(e.status===a||e.status===i?e.message:"An error occurred.")},e.error=function(e,n,r){t("Error contacting server. You might want to try again.")},$.ajax(e)}},{}],12:[function(e,t,n){var r={};r.environment=-1!==window.location.href.toLowerCase().indexOf("localhost")?"development":"production","development"===r.environment&&(r.geoLitEndpoint="http://localhost:3000"),r.commentEndpoint=r.geoLitEndpoint+"/discussion",r.userEndpoint=r.geoLitEndpoint+"/user",t.exports=r},{}],13:[function(e,t,n){(function(){function e(e){function t(t,n,r,a,i,o){for(;i>=0&&o>i;i+=e){var u=a?a[i]:i;r=n(r,t[u],u,t)}return r}return function(n,r,a,i){r=x(r,i,4);var o=!M(n)&&E.keys(n),u=(o||n).length,s=e>0?0:u-1;return arguments.length<3&&(a=n[o?o[s]:s],s+=e),t(n,r,a,o,s,u)}}function r(e){return function(t,n,r){n=w(n,r);for(var a=S(t),i=e>0?0:a-1;i>=0&&a>i;i+=e)if(n(t[i],i,t))return i;return-1}}function a(e,t,n){return function(r,a,i){var o=0,u=S(r);if("number"==typeof i)e>0?o=i>=0?i:Math.max(i+u,o):u=i>=0?Math.min(i+1,u):i+u+1;else if(n&&i&&u)return i=n(r,a),r[i]===a?i:-1;if(a!==a)return i=t(p.call(r,o,u),E.isNaN),i>=0?i+o:-1;for(i=e>0?o:u-1;i>=0&&u>i;i+=e)if(r[i]===a)return i;return-1}}function i(e,t){var n=N.length,r=e.constructor,a=E.isFunction(r)&&r.prototype||c,i="constructor";for(E.has(e,i)&&!E.contains(t,i)&&t.push(i);n--;)i=N[n],i in e&&e[i]!==a[i]&&!E.contains(t,i)&&t.push(i)}var o=this,u=o._,s=Array.prototype,c=Object.prototype,l=Function.prototype,f=s.push,p=s.slice,d=c.toString,m=c.hasOwnProperty,g=Array.isArray,h=Object.keys,v=l.bind,y=Object.create,b=function(){},E=function(e){return e instanceof E?e:this instanceof E?void(this._wrapped=e):new E(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=E),n._=E):o._=E,E.VERSION="1.8.3";var x=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)};case 4:return function(n,r,a,i){return e.call(t,n,r,a,i)}}return function(){return e.apply(t,arguments)}},w=function(e,t,n){return null==e?E.identity:E.isFunction(e)?x(e,t,n):E.isObject(e)?E.matcher(e):E.property(e)};E.iteratee=function(e,t){return w(e,t,1/0)};var j=function(e,t){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var a=1;r>a;a++)for(var i=arguments[a],o=e(i),u=o.length,s=0;u>s;s++){var c=o[s];t&&void 0!==n[c]||(n[c]=i[c])}return n}},C=function(e){if(!E.isObject(e))return{};if(y)return y(e);b.prototype=e;var t=new b;return b.prototype=null,t},k=function(e){return function(t){return null==t?void 0:t[e]}},R=Math.pow(2,53)-1,S=k("length"),M=function(e){var t=S(e);return"number"==typeof t&&t>=0&&R>=t};E.each=E.forEach=function(e,t,n){t=x(t,n);var r,a;if(M(e))for(r=0,a=e.length;a>r;r++)t(e[r],r,e);else{var i=E.keys(e);for(r=0,a=i.length;a>r;r++)t(e[i[r]],i[r],e)}return e},E.map=E.collect=function(e,t,n){t=w(t,n);for(var r=!M(e)&&E.keys(e),a=(r||e).length,i=Array(a),o=0;a>o;o++){var u=r?r[o]:o;i[o]=t(e[u],u,e)}return i},E.reduce=E.foldl=E.inject=e(1),E.reduceRight=E.foldr=e(-1),E.find=E.detect=function(e,t,n){var r;return r=M(e)?E.findIndex(e,t,n):E.findKey(e,t,n),void 0!==r&&-1!==r?e[r]:void 0},E.filter=E.select=function(e,t,n){var r=[];return t=w(t,n),E.each(e,function(e,n,a){t(e,n,a)&&r.push(e)}),r},E.reject=function(e,t,n){return E.filter(e,E.negate(w(t)),n)},E.every=E.all=function(e,t,n){t=w(t,n);for(var r=!M(e)&&E.keys(e),a=(r||e).length,i=0;a>i;i++){var o=r?r[i]:i;if(!t(e[o],o,e))return!1}return!0},E.some=E.any=function(e,t,n){t=w(t,n);for(var r=!M(e)&&E.keys(e),a=(r||e).length,i=0;a>i;i++){var o=r?r[i]:i;if(t(e[o],o,e))return!0}return!1},E.contains=E.includes=E.include=function(e,t,n,r){return M(e)||(e=E.values(e)),("number"!=typeof n||r)&&(n=0),E.indexOf(e,t,n)>=0},E.invoke=function(e,t){var n=p.call(arguments,2),r=E.isFunction(t);return E.map(e,function(e){var a=r?t:e[t];return null==a?a:a.apply(e,n)})},E.pluck=function(e,t){return E.map(e,E.property(t))},E.where=function(e,t){return E.filter(e,E.matcher(t))},E.findWhere=function(e,t){return E.find(e,E.matcher(t))},E.max=function(e,t,n){var r,a,i=-(1/0),o=-(1/0);if(null==t&&null!=e){e=M(e)?e:E.values(e);for(var u=0,s=e.length;s>u;u++)r=e[u],r>i&&(i=r)}else t=w(t,n),E.each(e,function(e,n,r){a=t(e,n,r),(a>o||a===-(1/0)&&i===-(1/0))&&(i=e,o=a)});return i},E.min=function(e,t,n){var r,a,i=1/0,o=1/0;if(null==t&&null!=e){e=M(e)?e:E.values(e);for(var u=0,s=e.length;s>u;u++)r=e[u],i>r&&(i=r)}else t=w(t,n),E.each(e,function(e,n,r){a=t(e,n,r),(o>a||a===1/0&&i===1/0)&&(i=e,o=a)});return i},E.shuffle=function(e){for(var t,n=M(e)?e:E.values(e),r=n.length,a=Array(r),i=0;r>i;i++)t=E.random(0,i),t!==i&&(a[i]=a[t]),a[t]=n[i];return a},E.sample=function(e,t,n){return null==t||n?(M(e)||(e=E.values(e)),e[E.random(e.length-1)]):E.shuffle(e).slice(0,Math.max(0,t))},E.sortBy=function(e,t,n){return t=w(t,n),E.pluck(E.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var _=function(e){return function(t,n,r){var a={};return n=w(n,r),E.each(t,function(r,i){var o=n(r,i,t);e(a,r,o)}),a}};E.groupBy=_(function(e,t,n){E.has(e,n)?e[n].push(t):e[n]=[t]}),E.indexBy=_(function(e,t,n){e[n]=t}),E.countBy=_(function(e,t,n){E.has(e,n)?e[n]++:e[n]=1}),E.toArray=function(e){return e?E.isArray(e)?p.call(e):M(e)?E.map(e,E.identity):E.values(e):[]},E.size=function(e){return null==e?0:M(e)?e.length:E.keys(e).length},E.partition=function(e,t,n){t=w(t,n);var r=[],a=[];return E.each(e,function(e,n,i){(t(e,n,i)?r:a).push(e)}),[r,a]},E.first=E.head=E.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:E.initial(e,e.length-t)},E.initial=function(e,t,n){return p.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},E.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:E.rest(e,Math.max(0,e.length-t))},E.rest=E.tail=E.drop=function(e,t,n){return p.call(e,null==t||n?1:t)},E.compact=function(e){return E.filter(e,E.identity)};var L=function(e,t,n,r){for(var a=[],i=0,o=r||0,u=S(e);u>o;o++){var s=e[o];if(M(s)&&(E.isArray(s)||E.isArguments(s))){t||(s=L(s,t,n));var c=0,l=s.length;for(a.length+=l;l>c;)a[i++]=s[c++]}else n||(a[i++]=s)}return a};E.flatten=function(e,t){return L(e,t,!1)},E.without=function(e){return E.difference(e,p.call(arguments,1))},E.uniq=E.unique=function(e,t,n,r){E.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=w(n,r));for(var a=[],i=[],o=0,u=S(e);u>o;o++){var s=e[o],c=n?n(s,o,e):s;t?(o&&i===c||a.push(s),i=c):n?E.contains(i,c)||(i.push(c),a.push(s)):E.contains(a,s)||a.push(s)}return a},E.union=function(){return E.uniq(L(arguments,!0,!0))},E.intersection=function(e){for(var t=[],n=arguments.length,r=0,a=S(e);a>r;r++){var i=e[r];if(!E.contains(t,i)){for(var o=1;n>o&&E.contains(arguments[o],i);o++);o===n&&t.push(i)}}return t},E.difference=function(e){var t=L(arguments,!0,!0,1);return E.filter(e,function(e){return!E.contains(t,e)})},E.zip=function(){return E.unzip(arguments)},E.unzip=function(e){for(var t=e&&E.max(e,S).length||0,n=Array(t),r=0;t>r;r++)n[r]=E.pluck(e,r);return n},E.object=function(e,t){for(var n={},r=0,a=S(e);a>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},E.findIndex=r(1),E.findLastIndex=r(-1),E.sortedIndex=function(e,t,n,r){n=w(n,r,1);for(var a=n(t),i=0,o=S(e);o>i;){var u=Math.floor((i+o)/2);n(e[u])<a?i=u+1:o=u}return i},E.indexOf=a(1,E.findIndex,E.sortedIndex),E.lastIndexOf=a(-1,E.findLastIndex),E.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),a=Array(r),i=0;r>i;i++,e+=n)a[i]=e;return a};var I=function(e,t,n,r,a){if(!(r instanceof t))return e.apply(n,a);var i=C(e.prototype),o=e.apply(i,a);return E.isObject(o)?o:i};E.bind=function(e,t){if(v&&e.bind===v)return v.apply(e,p.call(arguments,1));if(!E.isFunction(e))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),r=function(){return I(e,r,t,this,n.concat(p.call(arguments)))};return r},E.partial=function(e){var t=p.call(arguments,1),n=function(){for(var r=0,a=t.length,i=Array(a),o=0;a>o;o++)i[o]=t[o]===E?arguments[r++]:t[o];for(;r<arguments.length;)i.push(arguments[r++]);return I(e,n,this,this,i)};return n},E.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=E.bind(e[n],e);return e},E.memoize=function(e,t){var n=function(r){var a=n.cache,i=""+(t?t.apply(this,arguments):r);return E.has(a,i)||(a[i]=e.apply(this,arguments)),a[i]};return n.cache={},n},E.delay=function(e,t){var n=p.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},E.defer=E.partial(E.delay,E,1),E.throttle=function(e,t,n){var r,a,i,o=null,u=0;n||(n={});var s=function(){u=n.leading===!1?0:E.now(),o=null,i=e.apply(r,a),o||(r=a=null)};return function(){var c=E.now();u||n.leading!==!1||(u=c);var l=t-(c-u);return r=this,a=arguments,0>=l||l>t?(o&&(clearTimeout(o),o=null),u=c,i=e.apply(r,a),o||(r=a=null)):o||n.trailing===!1||(o=setTimeout(s,l)),i}},E.debounce=function(e,t,n){var r,a,i,o,u,s=function(){var c=E.now()-o;t>c&&c>=0?r=setTimeout(s,t-c):(r=null,n||(u=e.apply(i,a),r||(i=a=null)))};return function(){i=this,a=arguments,o=E.now();var c=n&&!r;return r||(r=setTimeout(s,t)),c&&(u=e.apply(i,a),i=a=null),u}},E.wrap=function(e,t){return E.partial(t,e)},E.negate=function(e){return function(){return!e.apply(this,arguments)}},E.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},E.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},E.before=function(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=null),n}},E.once=E.partial(E.before,2);var P=!{toString:null}.propertyIsEnumerable("toString"),N=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];E.keys=function(e){if(!E.isObject(e))return[];if(h)return h(e);var t=[];for(var n in e)E.has(e,n)&&t.push(n);return P&&i(e,t),t},E.allKeys=function(e){if(!E.isObject(e))return[];var t=[];for(var n in e)t.push(n);return P&&i(e,t),t},E.values=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=e[t[a]];return r},E.mapObject=function(e,t,n){t=w(t,n);for(var r,a=E.keys(e),i=a.length,o={},u=0;i>u;u++)r=a[u],o[r]=t(e[r],r,e);return o},E.pairs=function(e){for(var t=E.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=[t[a],e[t[a]]];return r},E.invert=function(e){for(var t={},n=E.keys(e),r=0,a=n.length;a>r;r++)t[e[n[r]]]=n[r];return t},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=j(E.allKeys),E.extendOwn=E.assign=j(E.keys),E.findKey=function(e,t,n){t=w(t,n);for(var r,a=E.keys(e),i=0,o=a.length;o>i;i++)if(r=a[i],t(e[r],r,e))return r},E.pick=function(e,t,n){var r,a,i={},o=e;if(null==o)return i;E.isFunction(t)?(a=E.allKeys(o),r=x(t,n)):(a=L(arguments,!1,!1,1),r=function(e,t,n){return t in n},o=Object(o));for(var u=0,s=a.length;s>u;u++){var c=a[u],l=o[c];r(l,c,o)&&(i[c]=l)}return i},E.omit=function(e,t,n){if(E.isFunction(t))t=E.negate(t);else{var r=E.map(L(arguments,!1,!1,1),String);t=function(e,t){return!E.contains(r,t)}}return E.pick(e,t,n)},E.defaults=j(E.allKeys,!0),E.create=function(e,t){var n=C(e);return t&&E.extendOwn(n,t),n},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e},E.isMatch=function(e,t){var n=E.keys(t),r=n.length;if(null==e)return!r;for(var a=Object(e),i=0;r>i;i++){var o=n[i];if(t[o]!==a[o]||!(o in a))return!1}return!0};var O=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof E&&(e=e._wrapped),t instanceof E&&(t=t._wrapped);var a=d.call(e);if(a!==d.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}var i="[object Array]"===a;if(!i){if("object"!=typeof e||"object"!=typeof t)return!1;var o=e.constructor,u=t.constructor;if(o!==u&&!(E.isFunction(o)&&o instanceof o&&E.isFunction(u)&&u instanceof u)&&"constructor"in e&&"constructor"in t)return!1}n=n||[],r=r||[];for(var s=n.length;s--;)if(n[s]===e)return r[s]===t;if(n.push(e),r.push(t),i){if(s=e.length,s!==t.length)return!1;for(;s--;)if(!O(e[s],t[s],n,r))return!1}else{var c,l=E.keys(e);if(s=l.length,E.keys(t).length!==s)return!1;for(;s--;)if(c=l[s],!E.has(t,c)||!O(e[c],t[c],n,r))return!1}return n.pop(),r.pop(),!0};E.isEqual=function(e,t){return O(e,t)},E.isEmpty=function(e){return null==e?!0:M(e)&&(E.isArray(e)||E.isString(e)||E.isArguments(e))?0===e.length:0===E.keys(e).length},E.isElement=function(e){return!(!e||1!==e.nodeType)},E.isArray=g||function(e){return"[object Array]"===d.call(e)},E.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},E.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){E["is"+e]=function(t){return d.call(t)==="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return E.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(E.isFunction=function(e){return"function"==typeof e||!1}),E.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},E.isNaN=function(e){return E.isNumber(e)&&e!==+e},E.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},E.isNull=function(e){return null===e},E.isUndefined=function(e){return void 0===e},E.has=function(e,t){return null!=e&&m.call(e,t)},E.noConflict=function(){return o._=u,this},E.identity=function(e){return e},E.constant=function(e){return function(){return e}},E.noop=function(){},E.property=k,E.propertyOf=function(e){return null==e?function(){}:function(t){return e[t]}},E.matcher=E.matches=function(e){return e=E.extendOwn({},e),function(t){return E.isMatch(t,e)}},E.times=function(e,t,n){var r=Array(Math.max(0,e));t=x(t,n,1);for(var a=0;e>a;a++)r[a]=t(a);return r},E.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},E.now=Date.now||function(){return(new Date).getTime()};var T={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},A=E.invert(T),F=function(e){var t=function(t){return e[t]},n="(?:"+E.keys(e).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,t):e}};E.escape=F(T),E.unescape=F(A),E.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),E.isFunction(r)?r.call(e):r};var q=0;E.uniqueId=function(e){var t=++q+"";return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var V=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\u2028|\u2029/g,B=function(e){return"\\"+D[e]};E.template=function(e,t,n){!t&&n&&(t=n),t=E.defaults({},t,E.templateSettings);var r=RegExp([(t.escape||V).source,(t.interpolate||V).source,(t.evaluate||V).source].join("|")+"|$","g"),a=0,i="__p+='";e.replace(r,function(t,n,r,o,u){return i+=e.slice(a,u).replace(z,B),a=u+t.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),t}),i+="';\n",t.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(t.variable||"obj","_",i)}catch(u){throw u.source=i,u}var s=function(e){return o.call(this,e,E)},c=t.variable||"obj";return s.source="function("+c+"){\n"+i+"}",s},E.chain=function(e){var t=E(e);return t._chain=!0,t};var $=function(e,t){return e._chain?E(t).chain():t};E.mixin=function(e){E.each(E.functions(e),function(t){var n=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return f.apply(e,arguments),$(this,n.apply(E,e))}})},E.mixin(E),E.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=s[e];E.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],$(this,n)}}),E.each(["concat","join","slice"],function(e){var t=s[e];E.prototype[e]=function(){return $(this,t.apply(this._wrapped,arguments))}}),E.prototype.value=function(){return this._wrapped},E.prototype.valueOf=E.prototype.toJSON=E.prototype.value,E.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return E})}).call(this)},{}]},{},[1]);